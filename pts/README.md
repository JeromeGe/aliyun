# 性能测试

这里所说的性能测试指模拟大量并发 HTTP 请求来压测服务，同时观察服务 tps 、响应时间、成功率等指标，以此来：

- 测试服务性能是否满足预估的并发需求。
- 寻找系统瓶颈以优化。

我们使用阿里云的性能测试服务来压测，具体使用方式请参考 https://help.aliyun.com/document_detail/29262.html?spm=5176.7739048.6.539.JKspQz 。

业务方如果有性能测试需求，请遵循以下流程：

- 提供以下文件：
    - 每个 pts 脚本一个子目录，目录名应该表明脚本测试的场景：
        - [如何编写脚本](https://help.aliyun.com/document_detail/54843.html?spm=5176.2020520153.0.0.782dd422uofHXJ)
        - 脚本应该可以请求到业务场景的主要路径，尤其是压力可能较大的部分。纯静态页面没必要压测。
        - 脚本应该合理避开热数据，防止因为只使用了热数据而无法测出数据库的瓶颈。多数性能问题都与数据库慢查询有关，请尤其注意优化数据库索引。
        - 若脚本需要配合参数文件，请将其提交到同一目录下，命名为 `params.csv` 。
        - 请确保测试不会产生过多垃圾数据。
        - 请自行注册阿里云账号测试，确保脚本可正确执行。
    - `README.md`：
        - 文档结构：
            - 业务描述
            - 并发预估
            - 压测计划
                - 持续时间
                - 并发人数
            - 测试场景（optional，描述需要用到的脚本和相关参数）
        - 请根据实际情况提供持续时间和并发用户数（必须），SRE 会适当配置施压机数量、梯度参数等。
- 评估费用，包含以下两部分：
    - SRE 支持所需人力，一般情况下（模拟 20 个以内请求或 5 个以内脚本）：
        - 检查提供的脚本和需求是否合理，需 2 人天。
        - 每执行一次需 1 人天（一天内多次只算一次），如需协助分析瓶颈、提供优化建议，再加 1 人天。
    - 阿里云 pts 费用，https://www.aliyun.com/price/product?spm=5176.doc29272.2.4.Vy677z#/pts/detail ，请根据计划压测的 `并发 * 时间 * 压测次数` 自行计算 VUM 后选择合适的付费方案。
